<form [formGroup]="form">
    <legend style="margin-top: 10px;">Dados do Equipamento</legend>

    <div class="card">
        <div class="card-body" formGroupName="deviceInfo">
            <div class="row">
                <div class="col-md-2 form-group was-validated" style="padding-right: 0;">
                    <label>IP</label>
                    <input type="text" pattern="([0-9]{1,3})[.]([0-9]{1,3})[.]([0-9]{1,3})[.]([0-9]{1,3})" class="form-control" formControlName="ipAddress"
                        required placeholder="Campo obrigatório">
                </div>
                <div class="col-md-1 form-group" style="padding-right: 0;">
                    <label>Porta</label>
                    <input mask="00000" type="text" class="form-control" formControlName="port" placeholder="161">
                </div>
                <div class="col-md-2 form-group was-validated" style="padding-right: 0;">
                    <label>Community</label>
                    <input type="text" class="form-control" formControlName="community" maxlength="25" required placeholder="Campo obrigatório">
                </div>
                <div class="col-md-1 form-group" style="padding-right: 0;">
                    <label>Versão</label>
                    <input type="text" class="form-control" formControlName="version" maxlength="4" placeholder="2c">
                </div>
                <div class="col-md-2 form-group" style="padding-right: 0;">
                    <label>Timeout</label>
                    <input mask="000000" type="text" class="form-control" formControlName="timeout" placeholder="1000">
                </div>
                <div class="col-md-2 form-group" style="padding-right: 0;">
                    <label>Retransmissões</label>
                    <input mask="0000" type="text" class="form-control" formControlName="retransmissions" placeholder="1">
                </div>
                <div class="col-md-2 form-group">
                    <input [disabled]="form.invalid || isLoadingDevice" style="position: absolute; bottom: 0; width: 82%;" class="btn btn-primary btn-block"
                        type="button" value="{{ 'Buscar' }}" (click)="sendDeviceOptions()">
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <label for="device-textarea-resume">Resumo do equipamento</label>

                    <div [ngClass]="{ 'loader': isLoadingDevice }"></div>
                    <div [ngClass]="{ 'loader--fieldset': isLoadingDevice }">
                        <textarea readonly class="form-control" id="device-textarea-resume" rows="5">{{ deviceInfos }}</textarea>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <legend style="margin-top: 10px;">Interfaces</legend>

    <div class="card">
        <div class="card-body">
            <div class="row">
                <div class="col-md-8 form-group">
                    <label>Interface</label>
                    <select (ngModelChange)="objChanged($event)" class="form-control" formControlName="interface">
                        <option [attr.selected]="i == 0 ? true : null" *ngFor="let interface of interfaces; let i = index" [value]="interface.oid">{{ interface.name }}</option>
                    </select>
                </div>
                <div class="col-md-2 form-group">
                    <label>Intervalo (segundos)</label>
                    <input mask="0000" type="text" class="form-control" formControlName="interval" placeholder="0">
                </div>
                <div class="col-md-2 form-group">
                    <input [disabled]="!deviceInfos || deviceInfos === 'Dispositivo não encontrado.' || isLoadingInterface || !interfaces" style="position: absolute; bottom: 0; width: 82%;"
                        class="btn btn-primary btn-block" type="button" value="{{ 'Buscar' }}"
                        (click)="sendInterfaceOptions()">
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <label>Resumo da interface</label>
                    <div [ngClass]="{ 'loader': isLoadingInterface || !interfaces }"></div>
                    <div [ngClass]="{ 'loader--fieldset': isLoadingInterface || !interfaces }">
                        <textarea readonly class="form-control" rows="7">{{ interfaceSummary }}</textarea>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <legend style="margin-top: 10px;">Taxa de Utilização</legend>

    <div class="card form-group">
        <div class="card-body">
            <div class="row">
                <div *ngIf="interfaceUsageRate" class="col-md-12">

                    <flot [refresh]="isLoadingFloat" [options]="options" [dataset]="dataset" height="550px" width="100%"></flot>

                    <br>
                    <span class="text-muted">Porcentagem de
                        <b>erro:</b><br>
                        &emsp;Entrada: {{ (interfaceUsageRate?.porcErrorIn ? interfaceUsageRate?.porcErrorIn + '%' :
                        '-' ) }} <br> 
                        &emsp;Saida: {{ (interfaceUsageRate?.porcErrorOut ? interfaceUsageRate?.porcErrorOut + '%' : '-') }}</span>
                    <br>
                    <br>
                    <span class="text-muted">Porcentagem de
                        <b>descarte:</b><br>
                        &emsp;Entrada: {{ (interfaceUsageRate?.porcDiscardIn ? interfaceUsageRate?.porcDiscardIn + '%'
                        : '-')}} <br>
                        &emsp;Saída:  {{ (interfaceUsageRate?.porcDiscardOut ? interfaceUsageRate?.porcDiscardOut + '%' : '-')
                        }}
                    </span>
                </div>
                <div *ngIf="!interfaceUsageRate" class="col-md-12">Selecione uma interface.</div>
            </div>
        </div>
    </div>
</form>